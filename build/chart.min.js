/*! datepicker 2014-06-08 */
var ChartModule=angular.module("ui.chart",[]);ChartModule.directive("mgBarChart",function(){var a=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){return"<strong>"+a.label+":</strong> <span style='color:red'>"+a.value+"</span>"});return{scope:{data:"=chartData",options:"=chartOptions"},restrict:"E",templateUrl:"chart.html",replace:!0,link:function(b,c){var d={width:800,height:500,padding:100},e={width:d.width-2*d.padding,height:d.height-2*d.padding},f=d3.select(c[0]).append("svg").attr("width",d.width).attr("height",d.height);b.$watch("data",function(b){f.selectAll("*").remove();var c=0;angular.forEach(b,function(a){Number(a.value)>c&&(c=Number(a.value))});var g=d3.scale.ordinal().rangeRoundBands([0,e.width],.1);g.domain(b.map(function(a){return a.label}));var h=d3.svg.axis().orient("bottom").scale(g),i=d3.scale.linear().range([e.height,0]);i.domain([0,c]);var j=d3.svg.axis().orient("left").scale(i);f.append("g").attr("class","x axis").attr("transform","translate("+d.padding+", "+(d.height-d.padding)+")").call(h).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(){return"rotate(-65)"}),f.call(a),f.append("g").attr("class","y axis").attr("transform","translate("+d.padding+","+d.padding+" )").call(j);var k=f.selectAll("rect").data(b).enter().append("rect");k.attr("x",function(a){return g(a.label)+d.padding}).attr("y",d.height-d.padding).attr("width",g.rangeBand()).attr("height",0).style("fill",function(a){return a.color}).transition().attr("y",function(a){return i(a.value)+d.padding}).attr("height",function(a){return e.height-i(a.value)}).duration(1e3)},!0)}}}),ChartModule.directive("mgPieChart",function(){var a=d3.tip().attr("class","d3-tip").html(function(a){return"<strong>"+a.data.label+":</strong> <span style='color:red'>"+a.data.value+"</span>"});return{scope:{data:"=chartData"},restrict:"E",templateUrl:"chart.html",replace:"true",link:function(b,c){var d={width:800,height:500,padding:50},e={width:d.width-2*d.padding,height:d.height-2*d.padding},f=Math.min(e.width,e.height)/2,g=d3.select(c[0]).append("svg").attr("width",d.width).attr("height",d.height).append("g").attr("transform","translate("+d.width/2+","+d.height/2+")");b.$watch("data",function(b){g.selectAll("*").remove(),g.call(a);{var c=d3.layout.pie().sort(null).value(function(a){return a.value}),d=d3.svg.arc().innerRadius(f-100).outerRadius(f-20);g.selectAll("path").data(c(b)).enter().append("path").attr("fill",function(a){return a.data.color}).on("mouseover",a.show).on("mouseout",a.hide).transition().delay(function(a,b){return 400*b}).attrTween("d",function(a){var b=d3.interpolate(a.startAngle+.1,a.endAngle);return function(c){return a.endAngle=b(c),d(a)}}).ease("bounce").duration(400)}},!0)}}}),ChartModule.directive("mgLineChart",function(){return{scope:{data:"=chartData"},restrict:"E",templateUrl:"chart.html",replace:"true",link:function(a,b){var c={width:800,height:500,padding:100},d={width:c.width-2*c.padding,height:c.height-2*c.padding},e=d3.select(b[0]).append("svg").attr("width",c.width).attr("height",c.height);a.$watch("data",function(a){e.selectAll("*").remove();var b=0,f=0;angular.forEach(a,function(a){f+=a.value,Number(a.value)>b&&(b=Number(a.value))});var g=d3.time.scale().range([0,d.width]),h=d3.scale.linear().range([d.height,0]),i=d3.svg.axis().scale(g).orient("bottom"),j=d3.svg.axis().scale(h).orient("left"),k=d3.svg.line().x(function(a){return g(a.x)}).y(function(a){return h(a.y)}),l=[],m=[],n=[],o=[];angular.forEach(a,function(a){l.push(d3.min(a.data,function(a){return a.x})),m.push(d3.max(a.data,function(a){return a.x})),n.push(d3.min(a.data,function(a){return a.y})),o.push(d3.max(a.data,function(a){return a.y}))}),g.domain(d3.extent(l.concat(m))),h.domain(d3.extent(n.concat(o))),e.append("g").attr("class","x axis").attr("transform","translate("+c.padding+", "+(c.height-c.padding)+")").call(i).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform",function(){return"rotate(-65)"}),e.append("g").attr("class","y axis").attr("transform","translate("+c.padding+", "+c.padding+")").call(j),angular.forEach(a,function(a,b){function d(){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,f.length+1));return function(b){return k(f.slice(0,a(b)))}}var f=angular.copy(a.data);f.sort(function(a,b){return a.x<b.x?-1:a.x>b.x?1:0}),e.append("path").datum(f).attr("class","line").attr("transform","translate("+c.padding+", "+c.padding+")").attr("stroke",a.color).transition().attrTween("d",d).ease("ease").duration(1e3),e.append("rect").attr("width",20).attr("height",20).attr("transform","translate("+(c.width-c.padding)+","+(25*b+c.padding)+")").attr("fill",a.color),e.append("text").attr("class","legend").attr("transform","translate("+(c.width-c.padding+25)+","+(25*b+c.padding+15)+")").text(a.label)})})}}}),angular.module("ui.chart").run(["$templateCache",function(a){"use strict";a.put("chart.html",'<div class="container">\n</div>')}]);